(this.webpackJsonpecommerce=this.webpackJsonpecommerce||[]).push([[0],{37:function(e,t,a){e.exports={Product:"Product_Product__2SI0Y",image:"Product_image__1Rr1p"}},38:function(e,t,a){e.exports={spinner:"Spinner_spinner__LTzVq",loading:"Spinner_loading__haEfk"}},39:function(e,t,a){e.exports={logo:"NavBar_logo__3hXp8",logout:"NavBar_logout__1ZR2r"}},54:function(e,t,a){e.exports=a(86)},85:function(e,t,a){},86:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"fetchCategories",(function(){return w})),a.d(n,"fetchPromotions",(function(){return F})),a.d(n,"createCategory",(function(){return I})),a.d(n,"createPromotion",(function(){return U})),a.d(n,"deleteCategory",(function(){return q})),a.d(n,"deletePromotion",(function(){return x})),a.d(n,"createProduct",(function(){return H})),a.d(n,"fetchProducts",(function(){return K})),a.d(n,"fetchProductsSnapshot",(function(){return z})),a.d(n,"getProduct",(function(){return J})),a.d(n,"updateProduct",(function(){return Q})),a.d(n,"deleteProduct",(function(){return $})),a.d(n,"loadProductsFormLocalStorage",(function(){return Y})),a.d(n,"removeProductFromLocalStorage",(function(){return B})),a.d(n,"createOrder",(function(){return G})),a.d(n,"deleteOrder",(function(){return W})),a.d(n,"fetchOrders",(function(){return X}));var r={};a.r(r),a.d(r,"authenticate",(function(){return Z})),a.d(r,"signUp",(function(){return ee})),a.d(r,"logout",(function(){return te})),a.d(r,"handleTimeout",(function(){return ae})),a.d(r,"removeAccessToken",(function(){return re})),a.d(r,"getAccessToken",(function(){return oe})),a.d(r,"onAuthStateChanged",(function(){return le}));var o=a(23),l=a(0),i=a.n(l),s=a(20),c=a.n(s),u=a(4),d=a(9),m=a(16),f=(a(63),a(64),a(22)),p=a(24),h=(a(65),a(21)),g=a(1),E=a(11),v=a(12),b=a(14),y=a(13),C=function(e,t){e.persist();var a=Object(g.a)({},t[e.target.name]);a.value="checkbox"===a.type?e.target.checked:e.target.value,a.isTouched=!0,O(a),N(a),t[e.target.name]=a;var n=!0;for(var r in t)n=t[r].isValid&&n;return{formModel:t,formIsValid:n}},O=function(e){return e.value=e.parseFun?e.parseFun(e.value):e.value},N=function(e){var t=M(e.value,e.validators);e.isValid=t},M=function(e,t){var a=!0;if(!t)return!0;if(t.isRequired){var n=""!==e.trim();t.isRequired.isValid=n,a=n&&a}if(t.minLength){var r=e.length>=t.minLength.minLength;t.minLength.isValid=r,a=r&&a}if(t.maxLength){var o=e.length<=t.maxLength.maxLength;t.maxLength.isValid=o,a=o&&a}if(t.isEmail){var l=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e);t.isEmail.isValid=l,a=l&&a}if(t.isNumeric){var i=/^\d+$/.test(e);t.isNumeric.isValid=i,a=i&&a}if(t.isDecimal){var s=/^\d+(\.\d+)?$/.test(e);t.isDecimal.isValid=s,a=s&&a}if(t.patternMatch){var c=t.patternMatch.pattern.test(e);t.patternMatch.isValid=c,a=c&&a}return a};var S=l.memo((function(e){var t=e.name,a=e.type,n=e.value,r=e.isValid,o=e.onChangeHandler,i=e.className;return l.createElement(l.Fragment,null,l.createElement("input",{id:t,name:t,type:a||"text",value:n||"",onChange:o,className:"form-control"+(r?"":" error")+(i?" "+i:"")}))}));var T=i.a.memo((function(e){var t=e.name,a=e.value,n=e.isValid,r=e.options,o=e.onChangeHandler,l=e.className;return i.a.createElement(i.a.Fragment,null,i.a.createElement("select",{id:t,name:t,value:a,onChange:o,className:"form-control"+(n?"":" error")+(l?" "+l:"")},r&&r.map((function(e){return i.a.createElement("option",{key:e.value,value:e.value},e.name)}))))}));var D=i.a.memo((function(e){var t=e.name,a=e.value,n=e.isValid,r=e.onChangeHandler;return i.a.createElement(i.a.Fragment,null,i.a.createElement("textarea",{id:t,name:t,value:a||"",onChange:r,className:"form-control"+(n?"":" error")}))})),V=i.a.memo((function(e){var t=null;return e.element.isTouched&&e.element.validators&&(t=Object.keys(e.element.validators).map((function(t,a){var n=e.element.validators[t];return n.isValid?null:i.a.createElement("small",{key:a,className:"error form-text"},n.message)}))),i.a.createElement(i.a.Fragment,null,t)})),P=a(25),R=a.n(P),_=a(31),j=a(34),k=a.n(j),L=(k.a.create({baseURL:"https://ecommerce-41f9c.firebaseio.com/"}),k.a.create({baseURL:"http://localhost/api/",withCredentials:!1}));L.interceptors.response.use((function(e){return e}),(function(e){var t="An error occured, response status: ";if(e.response)switch(e.response.status){case 401:r.getAccessToken()&&r.removeAccessToken(),A(e)||(window.location.href="/login");break;default:t+=e.response.status}throw A(e)||p.b.error(t),e}));var A=function(e){var t,a;return null===e||void 0===e||null===(t=e.request)||void 0===t||null===(a=t.responseURL)||void 0===a?void 0:a.includes("/api/users/current")},w=function(){return L.get("/categories").then((function(e){var t=[];return Object.keys(e.data).forEach((function(a){t.push({value:a,name:e.data[a]})})),t}))},F=function(){return L.get("/promotions").then((function(e){return e.data}))},I=function(e){return L.post("/categories",e)},U=function(e){return e.productID=e.product,L.post("/promotions",e)},q=function(e){return L.delete("/categories/".concat(e))},x=function(e){return L.delete("/promotions/".concat(e))},H=function(e){return L.post("/products",e)},K=function(){return L.get("/products").then((function(e){return e.data})).then((function(e){return e.map((function(e){return e.category=e.category.label,e}))}))},z=function(){return L.get("/products/snapshot").then((function(e){return e.data})).then((function(e){return e.map((function(e){return e.category=e.category.label,e}))}))},J=function(e){return L.get("/products/".concat(e)).then((function(e){return e.data})).then((function(e){return e.category=e.category.id,e}))},Q=function(e){return L.put("/products",e)},$=function(e){return L.delete("/products/".concat(e))},Y=function(){if(localStorage.getItem("CART")){var e=JSON.parse(localStorage.getItem("CART")),t=Object.keys(e).map((function(e){return J(e)}));return Promise.all(t)}return Promise.resolve([])},B=function(e){var t=JSON.parse(localStorage.getItem("CART"));delete t[e],0===Object.keys(t).length?localStorage.removeItem("CART"):localStorage.setItem("CART",JSON.stringify(Object(g.a)({},t)))},G=function(e){var t=Object(g.a)({},e);return L.post("/orders",t).then((function(e){return e.data}))},W=function(e){return L.delete("/orders/".concat(e))},X=function(){var e=Object(_.a)(R.a.mark((function e(t,a,n){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.post("/orders/search",{userID:t,offset:a-1,limit:n}).then((function(e){return e.data}));case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),Z=function(e,t){return L.post("/users/authenticate",{email:e,password:t}).then((function(e){return ne()}))},ee=function(e,t){return L.post("/users",{email:e,password:t})},te=function(){return L.post("/gateway/revoke-token",{token:"dummy"})},ae=function(){te().then((function(e){window.location.href="/re-login"}))},ne=function(){return L.get("/users/current").then((function(e){return{email:e.data.email,uid:e.data.id}}))},re=function(){},oe=function(){return null},le=function(e,t){ne().then((function(t){e(t)}),(function(e){t(e)}))},ie=function(e){return Object(u.b)((function(e){return{currentUser:e.login.user}}))((function(t){if(null===t.currentUser)return null;var a=i.a.createElement(e,null);return"anonymous"===t.currentUser&&(a=i.a.createElement(f.a,{to:"/login"})),a}))},se=ie(function(e){Object(b.a)(a,e);var t=Object(y.a)(a);function a(){var e;Object(E.a)(this,a);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={formModel:{title:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"Title is required"}}},category:{isValid:!1,isTouched:!1,value:"",options:[{value:"",name:"None"}],validators:{isRequired:{isValid:!1,message:"Category is required"}}},description:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"Description is Required"},minLength:{minLength:5,isValid:!1,message:"Description at least 5 char"},maxLength:{maxLength:100,isValid:!1,message:"Description max 100 char"}}},image:{isValid:!0,isTouched:!1,value:""},price:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"Price is Required"},isDecimal:{isValid:!1,message:"Price must be decimal"}}}},formIsValid:!1,displaySuccessMessage:!1},e.handleChange=function(t){var a=C(t,Object(g.a)({},e.state.formModel)),n=a.formModel,r=a.formIsValid;e.setState({formModel:n,formIsValid:r})},e.onSubmitForm=function(t){t.preventDefault();var a={};for(var r in e.state.formModel)a[r]=e.state.formModel[r].value;n.createProduct(a).then((function(t){201!==t.status&&200!==t.status||(e.setState({displaySuccessMessage:!0,formIsValid:!1}),e.resetForm())}))},e.resetForm=function(){var t=Object(g.a)({},e.state.formModel);Object.keys(t).forEach((function(e){t[e].value=""})),e.setState({formModel:t})},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=this;n.fetchCategories().then((function(t){var a=Object(g.a)({},e.state.formModel);a.category.options=[].concat(Object(h.a)(a.category.options),Object(h.a)(t)),e.setState({formModel:a})})).catch((function(t){e.setState({error:!0})}))}},{key:"render",value:function(){var e=this;return i.a.createElement(i.a.Fragment,null,this.state.displaySuccessMessage?i.a.createElement("div",{className:"container alert alert-success alert-dismissible fade show w-50",role:"alert"},"Product has been created successfully",i.a.createElement("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){return e.setState({displaySuccessMessage:!1})}},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))):null,i.a.createElement("form",{onSubmit:this.onSubmitForm,className:"container w-50"},i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"title"},"Title"),i.a.createElement(S,{name:"title",value:this.state.formModel.title.value,onChangeHandler:this.handleChange,isValid:!this.state.formModel.title.isTouched||this.state.formModel.title.validators.isRequired.isValid}),i.a.createElement(V,{element:this.state.formModel.title})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"description"},"Description"),i.a.createElement(D,{name:"description",value:this.state.formModel.description.value,onChangeHandler:this.handleChange,isValid:!this.state.formModel.description.isTouched||this.state.formModel.description.validators.isRequired.isValid&&this.state.formModel.description.validators.minLength.isValid&&this.state.formModel.description.validators.maxLength.isValid}),i.a.createElement(V,{element:this.state.formModel.description})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"category"},"Category"),i.a.createElement(T,{name:"category",value:this.state.formModel.category.value,options:this.state.formModel.category.options,onChangeHandler:this.handleChange,className:"col-5",isValid:!this.state.formModel.category.isTouched||this.state.formModel.category.validators.isRequired.isValid}),i.a.createElement(V,{element:this.state.formModel.category})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"image"},"Image"),i.a.createElement(S,{name:"image",className:"col-5",value:this.state.formModel.image.value,isValid:"true",onChangeHandler:this.handleChange})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"price"},"Price"),i.a.createElement(S,{name:"price",value:this.state.formModel.price.value,onChangeHandler:this.handleChange,className:"col-2",isValid:!this.state.formModel.price.isTouched||this.state.formModel.price.validators.isRequired.isValid&&this.state.formModel.price.validators.isDecimal.isValid}),i.a.createElement(V,{element:this.state.formModel.price})),i.a.createElement("button",{type:"submit",className:"btn "+(this.state.formIsValid?"btn-primary":"btn-secondary"),disabled:!this.state.formIsValid},"Submit")))}}]),a}(l.Component)),ce=function(e){return localStorage.removeItem("CART"),{type:"CHECKOUT_SUCCESS",order:e}},ue=function(e){Object(b.a)(a,e);var t=Object(y.a)(a);function a(){var e;Object(E.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={formModel:{cardNumber:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"PAN is required"},isNumeric:{isValid:!1,message:"PAN must be numeric"},minLength:{isValid:!1,minLength:16,message:"Validation number is of length 16"},maxLength:{isValid:!1,maxLength:16,message:"Validation number is of length 16"}}},expirationDate:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"expiration date is required"},patternMatch:{pattern:/^((0?[1-9]|1[012])[/]?[0-9]{2})*$/,isValid:!1,message:"expiration date must respect format MM/yy"}}},validationNumber:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"Validation number is required"},isNumeric:{isValid:!1,message:"Validation number must be numeric"},minLength:{minLength:3,isValid:!1,message:"Validation number must be of length 3"},maxLength:{maxLength:3,isValid:!1,message:"Validation number must be of length 3"}}}}},e.handleChange=function(t){var a=C(t,Object(g.a)({},e.state.formModel)),n=a.formModel,r=a.formIsValid;e.setState({formModel:n,formIsValid:r})},e.onCheckout=function(t){t.preventDefault();var a={};for(var n in e.state.formModel)a[n]=e.state.formModel[n].value;var r=e.props.products.map((function(e){return{productID:e.id,qty:e.qty}}));a.products=r,a.userID=e.props.user.uid,e.props.onCheckout(a)},e}return Object(v.a)(a,[{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("form",{className:"container"},i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"cardNumber"},"Card number"),i.a.createElement(S,{name:"cardNumber",value:this.state.formModel.cardNumber.value,onChangeHandler:this.handleChange,isValid:!this.state.formModel.cardNumber.isTouched||this.state.formModel.cardNumber.validators.isRequired.isValid&&this.state.formModel.cardNumber.validators.isNumeric.isValid&&this.state.formModel.cardNumber.validators.minLength.isValid&&this.state.formModel.cardNumber.validators.maxLength.isValid}),i.a.createElement(V,{element:this.state.formModel.cardNumber})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"expirationDate"},"Expiration Date"),i.a.createElement(S,{name:"expirationDate",value:this.state.formModel.expirationDate.value,onChangeHandler:this.handleChange,isValid:!this.state.formModel.expirationDate.isTouched||this.state.formModel.expirationDate.validators.isRequired.isValid&&this.state.formModel.expirationDate.validators.patternMatch.isValid}),i.a.createElement(V,{element:this.state.formModel.expirationDate})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"validationNumber"},"Validation Number"),i.a.createElement(S,{name:"validationNumber",value:this.state.formModel.validationNumber.value,onChangeHandler:this.handleChange,isValid:!this.state.formModel.validationNumber.isTouched||this.state.formModel.validationNumber.validators.isRequired.isValid&&this.state.formModel.validationNumber.validators.isNumeric.isValid&&this.state.formModel.validationNumber.validators.minLength.isValid&&this.state.formModel.validationNumber.validators.maxLength.isValid}),i.a.createElement(V,{element:this.state.formModel.validationNumber})),i.a.createElement("button",{type:"submit",className:"btn f-right "+(this.state.formIsValid?"btn-primary":"btn-secondary"),disabled:!this.state.formIsValid,onClick:this.onCheckout},"Submit")))}}]),a}(l.Component),de=Object(u.b)((function(e){return{products:e.cart.products,isLoading:e.cart.isLoading,displayCheckoutModal:e.cart.displayCheckoutModal,displaySuccessMessage:e.cart.displaySuccessMessage,user:e.login.user}}),(function(e){return{onCheckout:function(t){return e((a=t,function(){var e=Object(_.a)(R.a.mark((function e(t){var r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"CHECKOUT_START"}),e.next=3,n.createOrder(a);case 3:r=e.sent,t(ce(r));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));var a}}}))(ue);function me(e){var t=e.displayModal,a=e.title,n=e.className,r=e.closeModalHandler,o=e.children,l=e.submitHandler,s=e.disableActionSection;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"modal fade"+(t?" show d-block":" d-none"),"data-backdrop":"static",tabIndex:"-1",role:"dialog","aria-labelledby":"staticBackdropLabel","aria-hidden":!t,"aria-modal":t},i.a.createElement("div",{className:"modal-dialog "+(n||""),style:{maxWidth:"none"},role:"document"},i.a.createElement("div",{className:"modal-content"},a?i.a.createElement("div",{className:"modal-header"},i.a.createElement("h5",{className:"modal-title",id:"staticBackdropLabel"},a),i.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:r},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))):null,i.a.createElement("div",{className:"modal-body"},o),s?null:i.a.createElement("div",{className:"modal-footer"},i.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal",onClick:r},"Close"),i.a.createElement("button",{onClick:l,type:"button",className:"btn btn-primary"},"Submit"))))),i.a.createElement("div",{className:"modal-backdrop fade"+(t?" show d-block":" d-none")}))}var fe=function(e){Object(b.a)(a,e);var t=Object(y.a)(a);function a(){var e;Object(E.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={formModel:null,formIsValid:!0},e.handleChange=function(t){var a=C(t,Object(g.a)({},e.state.formModel)),n=a.formModel,r=a.formIsValid;e.setState({formModel:n,formIsValid:r},(function(){e.state.formModel[t.target.name].isValid&&e.props.onUpdateQty(e.state.formModel[t.target.name].productID,e.state.formModel[t.target.name].value)}))},e.getNbreTotalItems=function(){if(e.state.formModel){var t=Object.keys(e.state.formModel).map((function(t){return parseInt(e.state.formModel[t].value)})).reduce((function(e,t){return e+t}),0);return isNaN(t)?0:t}return 0},e.getTotalPrice=function(){var t=e.props.products.map((function(t){return parseFloat(t.promotion?t.price*(1-t.promotion.percentageOff/100):t.price)*parseInt(e.state.formModel["quantity"+t.id].value)})).reduce((function(e,t){return e+t}),0).toFixed(2);return isNaN(t)?0:t},e.remove=function(t){e.props.onRemoveProductFromCart(t.id);var a=Object(g.a)({},e.state.formModel);delete a["quantity"+t.id],e.setState({formModel:a})},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){this.props.onLoadProducts()}},{key:"componentDidUpdate",value:function(e,t){if(this.props.products!==e.products&&this.props.products.length>0){var a=Object(g.a)({},this.state.formModel);this.props.products.forEach((function(e){a["quantity"+e.id]={isValid:!0,isTouched:!1,value:e.qty,productID:e.id,validators:{isRequired:{isValid:!1,message:"QTY is required"},isNumeric:{isValid:!1,message:"QTY must be numeric"}}}})),this.setState({formModel:a})}}},{key:"componentWillUnmount",value:function(){this.props.onResetState()}},{key:"render",value:function(){var e=this;return i.a.createElement(i.a.Fragment,null,this.props.displaySuccessMessage?i.a.createElement("div",{className:"container alert alert-success alert-dismissible fade show w-50",role:"alert"},"Checkout OK",i.a.createElement("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:this.props.onCloseSuccessMessage},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))):null,this.props.products.length>0&&this.state.formModel?i.a.createElement("div",{className:"card w-75 mx-auto"},i.a.createElement("div",{className:"card-header"},"Shoping cart"),i.a.createElement("ul",{className:"list-group list-group-flush"},this.props.products.map((function(t){return i.a.createElement("li",{key:t.id,className:"list-group-item"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-4"},i.a.createElement("img",{src:"/assets/images/products/"+t.image,className:"card-img-top p-2 rounded ",style:{maxHeight:"200px"},alt:t.title})),i.a.createElement("div",{className:"col-5"},i.a.createElement("div",null,i.a.createElement("label",null,"Name: ")," ",t.title),i.a.createElement("div",null,i.a.createElement("label",null,"ISBN: ")," ",t.id),i.a.createElement("div",null,i.a.createElement("label",null,"Price: "),t.promotion?i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{className:"mx-2",style:{textDecoration:"line-through"}},t.price),i.a.createElement("span",null,t.price*(1-t.promotion.percentageOff/100)," ","$")):i.a.createElement("span",null," ",t.price," $"))),i.a.createElement("div",{className:"col-3"},i.a.createElement("div",null,i.a.createElement("label",null,"Qty: "),i.a.createElement(S,{name:"quantity"+t.id,className:"col-3 ml-2 d-inline",value:e.state.formModel["quantity"+t.id].value,onChangeHandler:e.handleChange,isValid:!e.state.formModel["quantity"+t.id].isTouched||e.state.formModel["quantity"+t.id].validators.isRequired.isValid}),i.a.createElement(V,{element:e.state.formModel["quantity"+t.id]}),i.a.createElement("button",{className:"btn btn-primary ml-2",onClick:function(){return e.remove(t)}},"Remove")))))}))),i.a.createElement("div",{className:"card-footer"},i.a.createElement("div",null,"Nbr Items : ",this.getNbreTotalItems()),i.a.createElement("div",null,"Total price : ",this.getTotalPrice()),this.props.isUserAuthenticated?i.a.createElement("button",{className:"btn float-right "+(this.state.formIsValid&&this.getNbreTotalItems()>0?"btn-primary":"btn-secondary"),disabled:!this.state.formIsValid||0===this.getNbreTotalItems(),onClick:this.props.onOpenCheckoutModal},"Checkout"):null)):this.props.isLoading?null:i.a.createElement("div",{className:"container alert alert-warning alert-dismissible fade show w-50",role:"alert"},"No product on cart"),this.props.displayCheckoutModal?i.a.createElement(me,{displayModal:this.props.displayCheckoutModal,closeModalHandler:this.props.onCloseCheckoutModal,className:"w-50",disableActionSection:!0,title:" "},i.a.createElement(de,null)):null)}}]),a}(l.Component),pe=Object(u.b)((function(e){return{products:e.cart.products,isLoading:e.cart.isLoading,displayCheckoutModal:e.cart.displayCheckoutModal,displaySuccessMessage:e.cart.displaySuccessMessage,isUserAuthenticated:e.login.user&&"anonymous"!==e.login.user}}),(function(e){return{onLoadProducts:function(){return e((function(e){e({type:"LOAD_PRODUCTS_START"}),n.loadProductsFormLocalStorage().then((function(t){var a=JSON.parse(localStorage.getItem("CART")),n=t.map((function(e){return Object(g.a)({},e,{qty:a[e.id]})}));e(function(e){return{type:"LOAD_PRODUCTS_SUCCESS",products:e}}(n))})).catch((function(t){e(function(e){return{type:"LOAD_PRODUCTS_FAIL",error:e}}(t))}))}))},onRemoveProductFromCart:function(t){return e(function(e){return n.removeProductFromLocalStorage(e),{type:"REMOVE_PRODUCT_FROM_CART",productID:e}}(t))},onOpenCheckoutModal:function(){return e({type:"OPEN_CHECKOUT_MODAL"})},onCloseCheckoutModal:function(){return e({type:"CLOSE_CHECKOUT_MODAL"})},onResetState:function(){return e({type:"RESET_CART_STATE"})},onCloseSuccessMessage:function(){return e({type:"CLOSE_SUCCESS_MESSAGE"})},onUpdateQty:function(t,a){return e(function(e,t){return{type:"UPDTATE_QTY",productID:e,qty:t}}(t,a))}}}))(fe),he=a(37),ge=a.n(he),Ee=a(89),ve=a(90),be=function(e){var t=e.product;return i.a.createElement(d.b,{to:"product/"+t.productID},i.a.createElement("div",{className:[ge.a.Product,"card"].join(" ")},i.a.createElement("img",{src:"/assets/images/products/"+t.image,className:"card-img-top p-2 rounded "+ge.a.image,alt:""}),i.a.createElement("div",{className:"card-body"},i.a.createElement("h5",{className:"card-title"},t.name),i.a.createElement("p",{className:"card-text"},t.description)),i.a.createElement("div",{className:"card-footer bg-transparent"},t.promotion&&function(e){var t=new Date;return Object(Ee.a)(t,Object(ve.a)(e.activeFrom))&&Object(Ee.a)(Object(ve.a)(e.activeTo),t)}(t.promotion)?i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{className:"mr-2",style:{textDecoration:"line-through"}},t.price),i.a.createElement("span",null,t.price*(1-t.promotion.percentageOff/100)," $")):i.a.createElement("span",null,t.price," $ "))))},ye=function(e){var t=e.products.map((function(e){return i.a.createElement("div",{key:e.id,className:"col text-center mb-5"},i.a.createElement(be,{product:e}))}));return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row"},t))},Ce={products:[],loading:!1},Oe=Object(o.b)({name:"home",initialState:Ce,reducers:{fetchProductsStart:function(e,t){e.loading=!0},fetchProductsSuccess:function(e,t){e.loading=!1,e.products=t.payload.products},fetchProductsFail:function(e,t){e.loading=!1},resetState:function(e){return Ce}}}),Ne=Oe.reducer,Me=Oe.actions.resetState,Se=function(){var e=Object(u.d)((function(e){return e.home.products})),t=Object(u.c)();return Object(l.useEffect)((function(){return t((function(e){e(Oe.actions.fetchProductsStart()),n.fetchProductsSnapshot().then((function(t){e(Oe.actions.fetchProductsSuccess({products:t}))})).catch((function(t){e(Oe.actions.fetchProductsFail({error:t}))}))})),function(){return t(Me())}}),[t]),i.a.createElement("div",{className:"container"},i.a.createElement("h4",{className:"mb-5"},"Products"),e&&i.a.createElement(ye,{products:e}))},Te=a(38),De=a.n(Te),Ve=i.a.memo((function(e){var t=e.loading,a=e.className;return i.a.createElement(i.a.Fragment,null,t?i.a.createElement("div",{className:De.a.spinner+(a||"")},i.a.createElement("div",{className:De.a.loading},i.a.createElement("div",{className:"spinner-border text-primary",role:"status"},i.a.createElement("span",{className:"sr-only"},"Loading..."))),i.a.createElement("div",{style:{opacity:.25},className:"modal-backdrop show d-block position-absolute w-100 h-100"})):null)})),Pe=a(7),Re=i.a.memo((function(e){var t=e.error,a=Object(l.useState)(!0),n=Object(Pe.a)(a,2),r=n[0],o=n[1],s=Object(l.useState)(),c=Object(Pe.a)(s,2),u=c[0],d=c[1];Object(l.useEffect)((function(){if(t)switch(t.code){case"auth/user-not-found":case"auth/wrong-password":d("Login/Password incorrect");break;case"auth/email-already-in-use":d(t.message);break;default:d(t.message)}}),[t]);return i.a.createElement(i.a.Fragment,null,u&&r?i.a.createElement("div",{className:"container alert alert-danger alert-dismissible fade show",role:"alert"},u,i.a.createElement("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){o(!1)}},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))):null)})),_e=i.a.memo((function(e){var t=e.name,a=(e.value,e.isValid,e.onChangeHandler),n=e.className;return i.a.createElement(i.a.Fragment,null,i.a.createElement("input",{id:t,name:t,type:"checkbox",onChange:a,className:n}))})),je={user:null,loading:!1,error:null},ke=Object(o.b)({name:"login",initialState:je,reducers:{authenticationStart:function(e,t){e.loading=!0},authenticationSuccess:function(e,t){e.loading=!1,e.user=t.payload.user},authenticationFailure:function(e,t){e.loading=!1,e.user="anonymous"},signupStart:function(e,t){e.loading=!0},signupSuccess:function(e,t){e.loading=!1,e.user=t.payload.user},signupFailure:function(e,t){e.loading=!1,e.error=t.error},logoutSuccess:function(e,t){e.user=t.payload.user},initAutheticatedUser:function(e,t){e.user=t.payload.user},resetState:function(e){return je}}}),Le=ke.reducer,Ae=ke.actions.resetState,we=function(e){Object(b.a)(a,e);var t=Object(y.a)(a);function a(){var e;Object(E.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={formModel:{email:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"Login is required"}}},password:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"Password is required"}}},isSignUp:{type:"checkbox",isValid:!0,isTouched:!1,value:!1}},formIsValid:!1},e.handleChange=function(t){var a=C(t,Object(g.a)({},e.state.formModel)),n=a.formModel,r=a.formIsValid;e.setState({formModel:n,formIsValid:r})},e.onSubmitForm=function(t){t.preventDefault(),e.state.formModel.isSignUp.value?e.props.onSignUp(e.state.formModel.email.value,e.state.formModel.password.value):e.props.onLogin(e.state.formModel.email.value,e.state.formModel.password.value)},e}return Object(v.a)(a,[{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return this.props.isUserAuthenticated?i.a.createElement(f.a,{to:"/"}):i.a.createElement("div",{className:"container w-50 position-relative"},i.a.createElement(Re,{error:this.props.error}),i.a.createElement("form",{onSubmit:this.onSubmitForm},i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"email"},"Email"),i.a.createElement(S,{name:"email",className:"col-9",value:this.state.formModel.email.value,onChangeHandler:this.handleChange,isValid:!this.state.formModel.email.isTouched||this.state.formModel.email.validators.isRequired.isValid}),i.a.createElement(V,{element:this.state.formModel.email})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"password"},"Password"),i.a.createElement(S,{name:"password",type:"password",className:"col-9",value:this.state.formModel.password.value,onChangeHandler:this.handleChange,isValid:!this.state.formModel.password.isTouched||this.state.formModel.password.validators.isRequired.isValid}),i.a.createElement(V,{element:this.state.formModel.password})),i.a.createElement("div",{className:"form-group form-check"},i.a.createElement(_e,{name:"isSignUp",className:"form-check-input",value:this.state.formModel.isSignUp.value,onChangeHandler:this.handleChange}),i.a.createElement("label",{className:"form-check-label",htmlFor:"isSignUp"},"Switch to Sign up mode ?")),i.a.createElement("button",{type:"submit",className:"btn "+(this.state.formIsValid?"btn-primary":"btn-secondary"),disabled:!this.state.formIsValid},"Submit")),i.a.createElement(Ve,{loading:this.props.loading}))}}]),a}(l.Component),Fe=Object(u.b)((function(e){return{user:e.login.user,isUserAuthenticated:e.login.user&&"anonymous"!==e.login.user,error:e.login.error,loading:e.login.loading}}),(function(e){return{onLogin:function(t,a){return e(function(e,t){return function(a){a(ke.actions.authenticationStart()),r.authenticate(e,t).then((function(e){a(ke.actions.authenticationSuccess({user:{email:e.email,uid:e.uid}}))})).catch((function(e){a(ke.actions.authenticationFailure({error:e.message}))}))}}(t,a))},onSignUp:function(t,a){return e(function(e,t){return function(a){a(ke.actions.signupStart()),r.signUp(e,t).then((function(e){a(ke.actions.signupSuccess({tokenInfo:e}))})).catch((function(e){a(ke.actions.signupFailure({error:e}))}))}}(t,a))},onClear:function(){return e(Ae())}}}))(we),Ie=function(e){var t=e.onCategoryAdded,a=Object(l.useState)({label:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"Label is required"}}}}),r=Object(Pe.a)(a,2),o=r[0],s=r[1],c=Object(l.useState)(!1),u=Object(Pe.a)(c,2),d=u[0],m=u[1],f=Object(l.useState)(!1),p=Object(Pe.a)(f,2),h=p[0],E=p[1],v=function(){var e=Object(g.a)({},o);Object.keys(e).forEach((function(t){e[t].value=""})),s(e),m(!1)};return i.a.createElement(i.a.Fragment,null,h&&i.a.createElement("div",{className:"container alert alert-success alert-dismissible fade show w-50",role:"alert"},"Category has been created successfully",i.a.createElement("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){return E(!1)}},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),i.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a={};for(var r in o)a[r]=o[r].value;n.createCategory(a).then((function(e){E(!0),v(),t()}))},className:"container w-50"},i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"label"},"Label"),i.a.createElement(S,{name:"label",value:o.label.value,onChangeHandler:function(e){var t=C(e,Object(g.a)({},o)),a=t.formModel,n=t.formIsValid;m(n),s(a)},className:"col-5",isValid:!o.label.isTouched||o.label.validators.isRequired.isValid}),i.a.createElement(V,{element:o.label})),i.a.createElement("button",{type:"submit",className:"btn "+(d?"btn-primary":"btn-secondary"),disabled:!d},"Add")))},Ue=function(e){var t=e.categories,a=e.onCategoryDeleted,r=Object(l.useState)(!1),o=Object(Pe.a)(r,2),s=o[0],c=o[1],u=Object(l.useState)(null),d=Object(Pe.a)(u,2),m=d[0],f=d[1];return i.a.createElement("div",null,i.a.createElement("div",{className:"container"},i.a.createElement("table",{className:"table table-striped"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{scope:"col"},"Label"),i.a.createElement("th",{scope:"col"},"Actions"))),i.a.createElement("tbody",null,t.map((function(e){return i.a.createElement("tr",{key:e.id},i.a.createElement("td",null,e.label),i.a.createElement("td",null,i.a.createElement("i",{style:{cursor:"pointer"},className:"fa fa-trash",onClick:function(){f(e.id),c(!0)}})))})))),i.a.createElement(me,{displayModal:s,closeModalHandler:function(){return c(!1)},submitHandler:function(){n.deleteCategory(m).then((function(e){c(!1),a()}))},className:"w-25"},"Are you sure what are you about to do ?")))},qe=function(){var e=Object(l.useState)(null),t=Object(Pe.a)(e,2),a=t[0],r=t[1];Object(l.useEffect)((function(){s()}),[]);var o=function(){s()},s=function(){n.fetchCategories().then((function(e){e=e.map((function(e){return{id:e.value,label:e.name}})),r(e)}))};return i.a.createElement(i.a.Fragment,null,i.a.createElement("h4",{className:"container w-50"},"Add a new category :"),i.a.createElement(Ie,{onCategoryAdded:o}),i.a.createElement("h4",{className:"container w-50 mt-4"},"List of categories:"),a&&i.a.createElement(Ue,{categories:a,onCategoryDeleted:o}))},xe=function(){return function(e){e(He()),n.fetchProducts().then((function(t){e(Ke(t))})).catch((function(t){e(ze(t))}))}},He=function(){return{type:"FETCH_PRODUCTS_START1"}},Ke=function(e){return{type:"FETCH_PRODUCTS_SUCCESS1",products:e}},ze=function(e){return{type:"FETCH_PRODUCTS_FAIL1",error:e}},Je=function(e){return function(t){n.updateProduct(e).then((function(e){t({type:"UPDATE_PRODUCT_SUCCESS"}),t(xe())}))}},Qe=function(e){return{type:"GET_PRODUCT_SUCCESS",product:e}},$e=function(e){return{type:"FETCH_CATEGORIES_SUCCESS",categories:e}},Ye=function(e){Object(b.a)(a,e);var t=Object(y.a)(a);function a(){var e;Object(E.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={formModel:{id:{value:"",isValid:!0},title:{isValid:!0,isTouched:!1,value:"",validators:{isRequired:{isValid:!0,message:"Title is required"}}},category:{isValid:!0,isTouched:!1,value:"",options:[{value:"",name:"None"}],validators:{isRequired:{isValid:!0,message:"Category is required"}}},description:{isValid:!0,isTouched:!1,value:"",validators:{isRequired:{isValid:!0,message:"Description is Required"},minLength:{minLength:5,isValid:!0,message:"Description at least 5 char"},maxLength:{maxLength:100,isValid:!0,message:"Description max 100 char"}}},image:{isValid:!0,isTouched:!1,value:""},price:{isValid:!0,isTouched:!1,value:"",validators:{isRequired:{isValid:!0,message:"Price is Required"},isDecimal:{isValid:!0,message:"Price must be decimal"}}}},formIsValid:!0},e.onEditProduct=function(t){t.preventDefault();var a={};for(var n in e.state.formModel)a[n]=e.state.formModel[n].value;e.props.onUpdateProduct(a)},e.handleChange=function(t){var a=C(t,Object(g.a)({},e.state.formModel)),n=a.formModel,r=a.formIsValid;e.setState({formModel:n,formIsValid:r})},e.resetForm=function(){var t=Object(g.a)({},e.state.formModel);Object.keys(t).forEach((function(e){t[e].value=""})),e.setState({formModel:t})},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){this.props.onFetchCategories()}},{key:"componentDidUpdate",value:function(e){if(this.props.product!==e.product){var t=Object(g.a)({},this.state.formModel),a=this.props.product;t.id.value=this.props.productID,t.title.value=a.title,t.description.value=a.description,t.price.value=a.price,t.image.value=a.image,t.category.value=a.category,this.setState({formModel:t})}if(1===this.state.formModel.category.options.length&&null!==this.props.categories){var n=Object(g.a)({},this.state.formModel);console.log("categories",this.props.categories);var r=[].concat(Object(h.a)(n.category.options),Object(h.a)(this.props.categories));n.category.options=r,this.setState({formModel:n})}}},{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("form",{className:"container"},i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"title"},"Title"),i.a.createElement(S,{name:"title",value:this.state.formModel.title.value,onChangeHandler:this.handleChange,isValid:!this.state.formModel.title.isTouched||this.state.formModel.title.validators.isRequired.isValid}),i.a.createElement(V,{element:this.state.formModel.title})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"description"},"Description"),i.a.createElement(D,{name:"description",value:this.state.formModel.description.value,onChangeHandler:this.handleChange,isValid:!this.state.formModel.description.isTouched||this.state.formModel.description.validators.isRequired.isValid&&this.state.formModel.description.validators.minLength.isValid&&this.state.formModel.description.validators.maxLength.isValid}),i.a.createElement(V,{element:this.state.formModel.description})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"category"},"Category"),i.a.createElement(T,{name:"category",value:this.state.formModel.category.value,options:this.state.formModel.category.options,onChangeHandler:this.handleChange,className:"col-5",isValid:!this.state.formModel.category.isTouched||this.state.formModel.category.validators.isRequired.isValid}),i.a.createElement(V,{element:this.state.formModel.category})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"image"},"Image"),i.a.createElement(S,{name:"image",className:"col-5",value:this.state.formModel.image.value,isValid:"true",onChangeHandler:this.handleChange})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"price"},"Price"),i.a.createElement(S,{name:"price",value:this.state.formModel.price.value,onChangeHandler:this.handleChange,className:"col-2",isValid:!this.state.formModel.price.isTouched||this.state.formModel.price.validators.isRequired.isValid&&this.state.formModel.price.validators.isDecimal.isValid}),i.a.createElement(V,{element:this.state.formModel.price})),i.a.createElement("button",{type:"submit",className:"btn f-right "+(this.state.formIsValid?"btn-primary":"btn-secondary"),disabled:!this.state.formIsValid,onClick:this.onEditProduct},"Submit")))}}]),a}(l.Component),Be=Object(u.b)((function(e){return{productID:e.manageProducts.productID,product:e.manageProducts.product,categories:e.manageProducts.categories}}),(function(e){return{onFetchCategories:function(){return e((function(e){n.fetchCategories().then((function(t){e($e(t))}))}))},onUpdateProduct:function(t){return e(Je(t))}}}))(Ye),Ge=ie(Object(u.b)((function(e){return{products:e.manageProducts.products,displayEditModal:e.manageProducts.displayEditModal,displayDeleteModalConfirmation:e.manageProducts.displayDeleteModalConfirmation,productID:e.manageProducts.productID}}),(function(e){return{onOpenUpdateProductModal:function(t){return e(function(e){return function(t){t({type:"OPEN_UPDATE_PRODUCT_MODAL",productID:e}),n.getProduct(e).then((function(e){t(Qe(e))}))}}(t))},onCloseUpdateProductModal:function(){return e({type:"CLOSE_UPDATE_PRODUCT_MODAL"})},onUpdateProduct:function(t){return e(Je(t))},onOpenDeleteProductModal:function(t){return e(function(e){return{type:"OPEN_DELETE_PRODUCT_MODAL",productID:e}}(t))},onCloseDeleteProductModal:function(){return e({type:"CLOSE_DELETE_PRODUCT_MODAL"})},onDeleteProduct:function(t){return e(function(e){return function(t){n.deleteProduct(e).then((function(e){t({type:"DELETE_PRODUCT_SUCCESS"}),t(xe())}))}}(t))}}}))((function(e){var t=Object(u.c)();return Object(l.useEffect)((function(){return t(xe())}),[t]),i.a.createElement("div",{className:"container"},i.a.createElement("table",{className:"table table-striped"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{scope:"col"},"Title"),i.a.createElement("th",{scope:"col"},"Category"),i.a.createElement("th",{scope:"col"},"Price"),i.a.createElement("th",{scope:"col"},"Actions"))),i.a.createElement("tbody",null,console.log(e.products),e.products.map((function(t){return i.a.createElement("tr",{key:t.id},i.a.createElement("td",null,t.title),i.a.createElement("td",null,t.category),i.a.createElement("td",null,t.price),i.a.createElement("td",null,i.a.createElement("i",{style:{cursor:"pointer"},className:"fa fa-edit mr-2",onClick:function(){return e.onOpenUpdateProductModal(t.id)}}),i.a.createElement("i",{style:{cursor:"pointer"},className:"fa fa-trash",onClick:function(){return e.onOpenDeleteProductModal(t.id)}})))})))),e.displayEditModal?i.a.createElement(me,{displayModal:e.displayEditModal,closeModalHandler:e.onCloseUpdateProductModal,className:"w-50",disableActionSection:!0,title:" "},i.a.createElement(Be,null)):null,i.a.createElement(me,{displayModal:e.displayDeleteModalConfirmation,closeModalHandler:e.onCloseDeleteProductModal,submitHandler:function(){return e.onDeleteProduct(e.productID)},className:"w-25"},"Are you sure what are you about to do ?"))}))),We=a(91),Xe=i.a.memo((function(e){for(var t=e.pagesCount,a=e.onPaginate,n=Object(l.useState)(1),r=Object(Pe.a)(n,2),o=r[0],s=r[1],c=t,u=function(e,t){t.preventDefault(),s(e),a(e)},d=[],m=function(e){d.push(i.a.createElement("li",{key:e,onClick:function(t){return u(e,t)},className:"page-item"+(o===e?" active":"")},i.a.createElement("a",{className:"page-link",href:"/"},e)))},f=1;f<=c;f++)m(f);return i.a.createElement(i.a.Fragment,null,c>1?i.a.createElement("nav",null,i.a.createElement("ul",{className:"pagination justify-content-center"},i.a.createElement("li",{onClick:function(e){return u(1,e)},className:"page-item"},i.a.createElement("a",{className:"page-link",href:"/","aria-label":"Previous"},i.a.createElement("span",{"aria-hidden":"true"},"\xab"))),d,i.a.createElement("li",{onClick:function(e){return u(c,e)},className:"page-item"},i.a.createElement("a",{className:"page-link",href:"/","aria-label":"Next"},i.a.createElement("span",{"aria-hidden":"true"},"\xbb"))))):null)})),Ze=function(e,t,a){return function(r){r({type:"FETCH_ORDERS_START"}),n.fetchOrders(e,t,a).then((function(e){var t=e.x,a=e.y;r(function(e,t){return{type:"FETCH_ORDERS_SUCCESS",orders:t,pagesCount:e}}(t,a))})).catch((function(e){r(function(e){return{type:"FETCH_ORDERS_FAIL",error:e}}(e))}))}},et=ie((function(){var e=Object(u.d)((function(e){return e.orders.orders})),t=Object(u.d)((function(e){return e.orders.pagesCount})),a=Object(u.d)((function(e){return e.orders.orderID})),r=Object(u.d)((function(e){return e.login.user})),o=Object(u.d)((function(e){return e.orders.loading})),s=Object(u.d)((function(e){return e.orders.displayDeleteModalConfirmation})),c=Object(u.c)();Object(l.useEffect)((function(){return r&&c(Ze(r.uid,1,3)),function(){return c({type:"RESET_ORDERS_STATE"})}}),[r,3,c]);return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"container position-relative"},i.a.createElement(Ve,{loading:o}),i.a.createElement(i.a.Fragment,null,i.a.createElement("table",{className:"table table-striped"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{scope:"col"},"Products"),i.a.createElement("th",{scope:"col"},"Date"),i.a.createElement("th",{scope:"col"},"Price"),i.a.createElement("th",{scope:"col"},"Status"),i.a.createElement("th",{scope:"col"},"Actions"))),i.a.createElement("tbody",null,e&&e.map((function(e){return i.a.createElement("tr",{key:e.id},i.a.createElement("td",null,e.products.map((function(e){return i.a.createElement(i.a.Fragment,{key:e.productID},i.a.createElement("div",null,e.title),i.a.createElement("div",null,"qty : ",e.qty))}))),i.a.createElement("td",null,Object(We.a)(new Date(e.creationDate),"dd/MM/yyyy HH:mm:ss")),i.a.createElement("td",null,e.price),i.a.createElement("td",null,e.status),i.a.createElement("td",null,"INITIATED"===e.status?i.a.createElement("i",{style:{cursor:"pointer"},className:"fa fa-trash",onClick:function(){return c(function(e){return{type:"OPEN_DELETE_ORDER_MODAL",orderID:e}}(e.id))}}):null))})))),i.a.createElement(Xe,{pagesCount:t,onPaginate:function(e){c(Ze(r.uid,e,3))}}))),i.a.createElement(me,{displayModal:s,closeModalHandler:function(){return c({type:"CLOSE_DELETE_ORDER_MODAL"})},submitHandler:function(){return c(function(e,t){return function(a){n.deleteOrder(e).then((function(e){a({type:"DELETE_ORDER_SUCCESS"}),a(Ze(t,1,3))}))}}(a,r.uid))},className:"w-25"},"Are you sure you want to delete this order ?"))})),tt=function(e){Object(b.a)(a,e);var t=Object(y.a)(a);function a(){var e;Object(E.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={product:null,isProductInStock:!0,formIsValid:!1,formModel:{quantity:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"QTY is required"},isNumeric:{isValid:!1,message:"QTY must be numeric"}}}}},e.handleChange=function(t){t.persist();var a=Object(g.a)({},e.state.formModel),n=a[t.target.name];n.value="checkbox"===n.type?t.target.checked:t.target.value,n.isTouched=!0,O(n),N(n);var r=!0;for(var o in a)r=a[o].isValid&&r;e.setState({formModel:a,formIsValid:r})},e.addToCart=function(t){if(t.preventDefault(),localStorage.getItem("CART")){var a=JSON.parse(localStorage.getItem("CART"));a[e.state.product.id]?a[e.state.product.id]=parseInt(a[e.state.product.id])+parseInt(e.state.formModel.quantity.value):a[e.state.product.id]=e.state.formModel.quantity.value,localStorage.setItem("CART",JSON.stringify(a))}else{var n={};n[e.state.product.id]=e.state.formModel.quantity.value,localStorage.setItem("CART",JSON.stringify(n))}e.props.history.push("/cart")},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;t&&n.getProduct(t).then((function(t){e.setState({product:t})}))}},{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,null!=this.state.product?i.a.createElement("div",{className:"container"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-4"},i.a.createElement("div",{className:"col-12"},i.a.createElement("div",null,i.a.createElement("img",{src:"/assets/images/products/"+this.state.product.image,className:"card-img-top p-2 rounded ",style:{maxHeight:"200px"},alt:this.state.product.title})))),i.a.createElement("div",{className:"col-8"},i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-header"},"Details"),i.a.createElement("ul",{className:"list-group list-group-flush"},i.a.createElement("li",{className:"list-group-item"},i.a.createElement("p",null,this.state.product.description)),i.a.createElement("li",{className:"list-group-item"},"Price: ",this.state.product.price),i.a.createElement("li",{className:"list-group-item"},"ISBN: ",this.state.product.id),i.a.createElement("li",{className:"list-group-item"},i.a.createElement("form",{onSubmit:this.addToCart},i.a.createElement("div",{className:"form-inline"},i.a.createElement("div",{className:"form-group",style:{width:"15%"}},i.a.createElement(S,{name:"quantity",className:"form-control col-11",value:this.state.formModel.quantity.value,onChangeHandler:this.handleChange,isValid:!this.state.formModel.quantity.isTouched||this.state.formModel.quantity.validators.isRequired.isValid}),i.a.createElement(V,{element:this.state.formModel.quantity})),i.a.createElement("button",{className:"btn "+(this.state.formIsValid?"btn-primary":"btn-secondary"),disabled:!this.state.formIsValid,type:"submit"},"Add to Cart")))),this.state.isProductInStock?null:i.a.createElement("div",null,i.a.createElement("div",null,"Out of stock"))))))):null)}}]),a}(l.Component),at=a(39),nt=a.n(at),rt=function(e){Object(b.a)(a,e);var t=Object(y.a)(a);function a(){var e;Object(E.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={displaySubMenu:!1},e.toggleDropDown=function(){e.setState((function(e){return{displaySubMenu:!e.displaySubMenu}}))},e.logout=function(){e.props.onLogout()},e}return Object(v.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light h5"},i.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},i.a.createElement("span",{className:"navbar-toggler-icon"})),i.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},i.a.createElement("ul",{className:"navbar-nav mx-auto"},i.a.createElement("li",{className:["nav-item",nt.a.logo].join(" ")},i.a.createElement("a",{href:"/",className:"nav-link active"},i.a.createElement("i",{className:"fa fa-cloud fa-2x align-middle"}),i.a.createElement("span",{className:"ml-1 mb-3"},"Cloud Shop"))),i.a.createElement("li",{className:"nav-item mr-3 my-auto"},i.a.createElement(d.b,{to:"/",exact:!0,className:"nav-link"},"Home ",i.a.createElement("span",{className:"sr-only"},"(current)"))),this.props.isUserAuthenticated?i.a.createElement("li",{className:"nav-item mr-3 my-auto"},i.a.createElement(d.b,{to:"/orders",exact:!0,className:"nav-link"},"Orders")):null,i.a.createElement("li",{className:"nav-item mr-3 my-auto"},i.a.createElement(d.b,{to:"/cart",exact:!0,className:"nav-link"},i.a.createElement("i",{className:"fa fa-shopping-cart"}),i.a.createElement("span",{className:"ml-1"},"Cart"))),this.props.isUserAuthenticated?i.a.createElement("li",{className:"nav-item dropdown mr-3 my-auto "+(this.state.displaySubMenu?"show":"")},i.a.createElement("button",{className:"nav-link dropdown-toggle bg-light border-0",id:"navbarDropdown","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":this.state.displaySubMenu,onClick:function(){return e.toggleDropDown()}},i.a.createElement("i",{className:"fa fa-cog"}),i.a.createElement("span",{className:"ml-1"},"Settings")),i.a.createElement("div",{className:"dropdown-menu "+(this.state.displaySubMenu?"show":""),"aria-labelledby":"navbarDropdown"},i.a.createElement(d.b,{to:"/add-product",exact:!0,className:"dropdown-item",onClick:function(){return e.toggleDropDown()}},i.a.createElement("i",{className:"fa fa-cog"}),i.a.createElement("span",{className:"ml-1"},"Add Product")),i.a.createElement(d.b,{to:"/manage-products",exact:!0,className:"dropdown-item",onClick:function(){return e.toggleDropDown()}},i.a.createElement("i",{className:"fa fa-cog"}),i.a.createElement("span",{className:"ml-1"},"Manage Products")),i.a.createElement(d.b,{to:"/manage-categories",exact:!0,className:"dropdown-item",onClick:function(){return e.toggleDropDown()}},i.a.createElement("i",{className:"fa fa-cog"}),i.a.createElement("span",{className:"ml-1"},"Manage Categories")),i.a.createElement(d.b,{to:"/manage-promotions",exact:!0,className:"dropdown-item",onClick:function(){return e.toggleDropDown()}},i.a.createElement("i",{className:"fa fa-cog"}),i.a.createElement("span",{className:"ml-1"},"Manage Promotions")))):null,this.props.isUserAuthenticated?null:i.a.createElement("li",{className:"nav-item mr-3 my-auto"},i.a.createElement(d.b,{to:"/login",exact:!0,className:"nav-link"},i.a.createElement("i",{className:"fa fa-sign-in"}),i.a.createElement("span",{className:"ml-1"},"Login"))),this.props.isUserAuthenticated?i.a.createElement("li",{className:"nav-item mr-3 my-auto"},i.a.createElement("button",{className:["nav-link bg-light border-0",nt.a.logout].join(" "),onClick:this.props.onLogout},i.a.createElement("i",{className:"fa fa-sign-out"}),i.a.createElement("span",{className:"ml-1"},"Logout"))):null)))}}]),a}(l.Component),ot=Object(u.b)((function(e){return{isUserAuthenticated:e.login.user&&"anonymous"!==e.login.user}}),(function(e){return{onLogout:function(){return e((function(e){r.logout().then((function(t){e(ke.actions.logoutSuccess({user:"anonymous"})),window.location.href="/login"}))}))}}}))(rt),lt=function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(ot,null),i.a.createElement("main",{className:"pt-5"},e.children))},it=function(e){var t=e.onPromotionAdded,a=Object(l.useState)({label:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"Label is required"}}},product:{isValid:!1,isTouched:!1,value:"",options:[{name:"Select a product",value:""}],validators:{isRequired:{isValid:!1,message:"Product is required"}}},percentageOff:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"Percentage Off is required"},isDecimal:{isValid:!1,message:"Percentage Off must be decimal"}}},activeFrom:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"Date activation is required"}}},activeTo:{isValid:!1,isTouched:!1,value:"",validators:{isRequired:{isValid:!1,message:"Date activation is required"}}}}),r=Object(Pe.a)(a,2),o=r[0],s=r[1],c=Object(l.useState)(!1),u=Object(Pe.a)(c,2),d=u[0],m=u[1],f=Object(l.useState)(!1),p=Object(Pe.a)(f,2),E=p[0],v=p[1];Object(l.useEffect)((function(){n.fetchProducts().then((function(e){var t=e.map((function(e){return{name:e.title,value:e.id}})),a=Object(g.a)({},o,{product:Object(g.a)({},o.product)});a.product.options=[].concat(Object(h.a)(a.product.options),Object(h.a)(t)),s(a)}))}),[]);var b=function(e){var t=C(e,Object(g.a)({},o)),a=t.formModel,n=t.formIsValid;m(n),s(a),console.log("formMOdel",o)},y=function(){var e=Object(g.a)({},o);Object.keys(e).forEach((function(t){e[t].value=""})),s(e),m(!1)};return i.a.createElement(i.a.Fragment,null,E&&i.a.createElement("div",{className:"container alert alert-success alert-dismissible fade show w-50",role:"alert"},"Promotion has been created successfully",i.a.createElement("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){return v(!1)}},i.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),i.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a={};for(var r in o)a[r]=o[r].value;n.createPromotion(a).then((function(e){v(!0),y(),t()}))},className:"container w-50"},i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"label"},"Label"),i.a.createElement(S,{name:"label",value:o.label.value,onChangeHandler:b,className:"col-5",isValid:!o.label.isTouched||o.label.validators.isRequired.isValid}),i.a.createElement(V,{element:o.label})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"product"},"Product"),i.a.createElement(T,{name:"product",value:o.product.value,options:o.product.options,onChangeHandler:b,className:"col-5",isValid:!o.product.isTouched||o.product.validators.isRequired.isValid}),i.a.createElement(V,{element:o.product})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"activeFrom"},"Activated from"),i.a.createElement(S,{name:"activeFrom",type:"date",value:o.activeFrom.value,onChangeHandler:b,className:"col-5",isValid:!o.activeFrom.isTouched||o.activeFrom.validators.isRequired.isValid}),i.a.createElement(V,{element:o.activeFrom})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"activeTo"},"Activated To"),i.a.createElement(S,{name:"activeTo",type:"date",value:o.activeTo.value,onChangeHandler:b,className:"col-5",isValid:!o.activeTo.isTouched||o.activeTo.validators.isRequired.isValid}),i.a.createElement(V,{element:o.activeTo})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"activeTo"},"Percentage Off"),i.a.createElement(S,{name:"percentageOff",value:o.percentageOff.value,onChangeHandler:b,className:"col-3",isValid:!o.percentageOff.isTouched||o.percentageOff.validators.isRequired.isValid&&o.percentageOff.validators.isDecimal.isValid}),i.a.createElement(V,{element:o.percentageOff})),i.a.createElement("button",{type:"submit",className:"btn "+(d?"btn-primary":"btn-secondary"),disabled:!d},"Add")))},st=function(e){var t=e.promotions,a=e.onPromotionDeleted,r=Object(l.useState)(!1),o=Object(Pe.a)(r,2),s=o[0],c=o[1],u=Object(l.useState)(null),d=Object(Pe.a)(u,2),m=d[0],f=d[1];return i.a.createElement("div",null,i.a.createElement("div",{className:"container"},i.a.createElement("table",{className:"table table-striped"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{scope:"col"},"Label"),i.a.createElement("th",{scope:"col"},"Product"),i.a.createElement("th",{scope:"col"},"Percentage Off"),i.a.createElement("th",{scope:"col"},"Active From"),i.a.createElement("th",{scope:"col"},"To"),i.a.createElement("th",{scope:"col"},"Actions"))),i.a.createElement("tbody",null,t.map((function(e){return console.log(e),i.a.createElement("tr",{key:e.id},i.a.createElement("td",null,e.label),i.a.createElement("td",null,e.productID),i.a.createElement("td",null,e.percentageOff),i.a.createElement("td",null,e.activeFrom),i.a.createElement("td",null,e.activeTo),i.a.createElement("td",null,i.a.createElement("i",{style:{cursor:"pointer"},className:"fa fa-trash",onClick:function(){f(e.id),c(!0)}})))})))),i.a.createElement(me,{displayModal:s,closeModalHandler:function(){return c(!1)},submitHandler:function(){n.deletePromotion(m).then((function(e){c(!1),a()}))},className:"w-25"},"Are you sure what are you about to do ?")))},ct=function(){var e=Object(l.useState)(null),t=Object(Pe.a)(e,2),a=t[0],r=t[1];Object(l.useEffect)((function(){s()}),[]);var o=function(){s()},s=function(){n.fetchPromotions().then((function(e){r(e)}))};return i.a.createElement(i.a.Fragment,null,i.a.createElement("h4",{className:"container w-50"},"Add a new promotion :"),i.a.createElement(it,{onPromotionAdded:o}),i.a.createElement("h4",{className:"container w-50 mt-4"},"List of promotions:"),a&&i.a.createElement(st,{promotions:a,onPromotionDeleted:o}))},ut=(ie(ct),a(53)),dt=function(){return Object(l.useEffect)((function(){p.b.warn("You've been inactive for a long time, please login again")}),[]),i.a.createElement(f.a,{to:"/login"})};var mt=function(){var e=Object(u.c)();Object(l.useEffect)((function(){e((function(e){r.onAuthStateChanged((function(t){t=t?{email:t.email,uid:t.uid}:"anonymous",e(ke.actions.authenticationSuccess({user:t}))}),(function(t){return e(ke.actions.authenticationFailure({error:t}))}))}))}),[e]);var t=Object(ut.a)({timeout:9e5,onIdle:function(e){console.log("user is idle",e),console.log("last active",t()),r.handleTimeout()},debounce:500}).getLastActiveTime;return i.a.createElement(i.a.Fragment,null,i.a.createElement(lt,null,i.a.createElement(f.d,null,i.a.createElement(f.b,{path:"/login",component:Fe}),i.a.createElement(f.b,{path:"/re-login",component:dt}),i.a.createElement(f.b,{path:"/cart",component:pe}),i.a.createElement(f.b,{exact:!0,path:"/product/:id",component:tt}),i.a.createElement(f.b,{path:"/add-Product",component:se}),i.a.createElement(f.b,{path:"/manage-products",component:Ge}),i.a.createElement(f.b,{path:"/manage-categories",component:qe}),i.a.createElement(f.b,{path:"/manage-promotions",component:ct}),i.a.createElement(f.b,{path:"/orders",component:et}),i.a.createElement(f.b,{path:"/",exact:!0,component:Se}))),i.a.createElement(p.a,null))},ft=(a(85),function(e,t){return Object(g.a)({},e,{},t)}),pt={products:[],isLoading:!0,displayCheckoutModal:!1,displaySuccessMessage:!1},ht=function(e){return ft(e,{isLoading:!0})},gt=function(e,t){return ft(e,{products:t.products,isLoading:!1})},Et=function(e,t){return ft(e,{isLoading:!1})},vt=function(e,t){var a=e.products.filter((function(e){return e.id!==t.productID}));return ft(e,{products:a})},bt=function(e,t){return ft(e)},yt=function(e,t){return ft(e,{displaySuccessMessage:!0,displayCheckoutModal:!1,products:[]})},Ct=function(e,t){return ft(e,{displaySuccessMessage:!1,displayCheckoutModal:!1})},Ot=function(e,t){return ft(e,{displayCheckoutModal:!0})},Nt=function(e,t){return ft(e,{displayCheckoutModal:!1})},Mt=function(e,t){return ft(e,{displaySuccessMessage:!1})},St=function(e,t){var a=Object(g.a)({},e),n=a.products.map((function(e,a){return e.id!==t.productID?e:Object(g.a)({},e,{qty:t.qty})}));return a.products=n,ft(e,a)},Tt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_PRODUCTS_START":return ht(e);case"LOAD_PRODUCTS_SUCCESS":return gt(e,t);case"LOAD_PRODUCTS_FAIL":return Et(e);case"REMOVE_PRODUCT_FROM_CART":return vt(e,t);case"OPEN_CHECKOUT_MODAL":return Ot(e);case"CLOSE_CHECKOUT_MODAL":return Nt(e);case"CHECKOUT_START":return bt(e);case"CHECKOUT_SUCCESS":return yt(e);case"CHECKOUT_FAIL":return Ct(e);case"CLOSE_SUCCESS_MESSAGE":return Mt(e);case"UPDTATE_QTY":return St(e,t);case"RESET_CART_STATE":return Object(g.a)({},pt);default:return e}},Dt={products:[],loading:!1,productID:null,product:null,displayEditModal:!1,displayDeleteModalConfirmation:!1,categories:null},Vt=function(e){return ft(e,{loading:!0})},Pt=function(e,t){return ft(e,{products:t.products,loading:!1})},Rt=function(e,t){return ft(e,{loading:!1})},_t=function(e,t){return ft(e,{displayEditModal:!1})},jt=function(e,t){return ft(e,{product:t.product})},kt=function(e,t){return ft(e,{displayEditModal:!0,productID:t.productID})},Lt=function(e,t){return ft(e,{displayEditModal:!1})},At=function(e,t){return ft(e,{displayDeleteModalConfirmation:!0,productID:t.productID})},wt=function(e,t){return ft(e,{displayDeleteModalConfirmation:!1})},Ft=function(e,t){return ft(e,{displayDeleteModalConfirmation:!1})},It=function(e,t){return ft(e,{categories:t.categories})},Ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_PRODUCTS_START1":return Vt(e);case"FETCH_PRODUCTS_SUCCESS1":return Pt(e,t);case"FETCH_PRODUCTS_FAIL1":return Rt(e);case"OPEN_UPDATE_PRODUCT_MODAL":return kt(e,t);case"CLOSE_UPDATE_PRODUCT_MODAL":return Lt(e);case"GET_PRODUCT_SUCCESS":return jt(e,t);case"UPDATE_PRODUCT_SUCCESS":return _t(e);case"OPEN_DELETE_PRODUCT_MODAL":return At(e,t);case"CLOSE_DELETE_PRODUCT_MODAL":return wt(e);case"DELETE_PRODUCT_SUCCESS":return Ft(e);case"FETCH_CATEGORIES_SUCCESS":return It(e,t);default:return e}},qt={orders:[],pagesCount:null,orderID:null,loading:!1,displayDeleteModalConfirmation:!1},xt=function(e){return ft(e,{loading:!0})},Ht=function(e,t){return ft(e,{orders:t.orders,pagesCount:t.pagesCount,loading:!1})},Kt=function(e,t){return ft(e,{loading:!1})},zt=function(e,t){return ft(e,{displayDeleteModalConfirmation:!0,orderID:t.orderID})},Jt=function(e,t){return ft(e,{displayDeleteModalConfirmation:!1})},Qt=function(e,t){return ft(e,{displayDeleteModalConfirmation:!1})},$t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_ORDERS_START":return xt(e);case"FETCH_ORDERS_SUCCESS":return Ht(e,t);case"FETCH_ORDERS_FAIL":return Kt(e);case"OPEN_DELETE_ORDER_MODAL":return zt(e,t);case"CLOSE_DELETE_ORDER_MODAL":return Jt(e);case"DELETE_ORDER_SUCCESS":return Qt(e);case"RESET_ORDERS_STATE":return Object(g.a)({},qt);default:return e}},Yt=Object(m.c)({home:Ne,manageProducts:Ut,login:Le,cart:Tt,orders:$t}),Bt=Object(o.a)({reducer:Yt});c.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(u.a,{store:Bt},i.a.createElement(d.a,null,i.a.createElement(mt,null)))),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.d5eddb6d.chunk.js.map